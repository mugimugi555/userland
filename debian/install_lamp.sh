#!/bin/bash

# ======================================================================================================================
# one liner command
# ======================================================================================================================
# sudo apt update -y ; sudo apt install -y wget ; wget https://raw.githubusercontent.com/mugimugi555/userland/main/debian/install_lamp.sh && bash install_lamp.sh ;

# ======================================================================================================================
# install lamp
# ======================================================================================================================
sudo apt install -y apache2 php php-mysql mariadb-server ;

# ======================================================================================================================
# config
# ======================================================================================================================
sudo sed -i '/Listen/{s/\([0-9]\+\)/8080/; :a;n; ba}' /etc/apache2/ports.conf

# ======================================================================================================================
# auto start
# ======================================================================================================================
echo "export LD_LIBRARY_PATH=\"\"" | sudo tee -a /support/startVNCServerStep2.sh ;
echo "/usr/sbin/apachectl start"   | sudo tee -a /support/startVNCServerStep2.sh ;
echo "sudo service mysql start"    | sudo tee -a /support/startVNCServerStep2.sh ;

# ======================================================================================================================
# start
# ======================================================================================================================
sudo service mysql start ;
/usr/sbin/apachectl start ;

# ======================================================================================================================
# finish
# ======================================================================================================================
LOCAL_IPADDRESS=`hostname -I | awk -F" " '{print $1}'` ;
echo "======================================" ;
echo "visit => http://$LOCAL_IPADDRESS:8080/" ;
echo "======================================" ;
